*DECK DBIE
      REAL*8 FUNCTION DBIE (X)
C***BEGIN PROLOGUE  DBIE
C***PURPOSE  Calculate the Bairy function for a negative argument and an
C            exponentially scaled Bairy function for a non-negative
C            argument.
C***LIBRARY   SLATEC (FNLIB)
C***CATEGORY  C10D
C***TYPE      REAL*8 (BIE-S, DBIE-D)
C***KEYWORDS  BAIRY FUNCTION, EXPONENTIALLY SCALED, FNLIB,
C             SPECIAL FUNCTIONS
C***AUTHOR  Fullerton, W., (LANL)
C***DESCRIPTION
C
C DBIE(X) calculates the double precision Airy function of the
C second kind or the double precision exponentially scaled Airy
C function of the second kind, depending on the value of the
C double precision argument X.
C
C Evaluate BI(X) for X .LE. 0.0  and  BI(X)*EXP(-ZETA)  where
C ZETA = 2/3 * X**(3/2)  for X .GE. 0.0
C
C
C Series for BIF        on the interval -1.00000E+00 to  1.00000E+00
C                                        with weighted error   1.45E-32
C                                         log weighted error  31.84
C                               significant figures required  30.85
C                                    decimal places required  32.40
C
C
C Series for BIG        on the interval -1.00000E+00 to  1.00000E+00
C                                        with weighted error   1.29E-33
C                                         log weighted error  32.89
C                               significant figures required  31.48
C                                    decimal places required  33.45
C
C
C Series for BIF2       on the interval  1.00000E+00 to  8.00000E+00
C                                        with weighted error   6.08E-32
C                                         log weighted error  31.22
C                        approx significant figures required  30.8
C                                    decimal places required  31.80
C
C
C Series for BIG2       on the interval  1.00000E+00 to  8.00000E+00
C                                        with weighted error   4.91E-33
C                                         log weighted error  32.31
C                        approx significant figures required  31.6
C                                    decimal places required  32.90
C
C
C Series for BIP1       on the interval  1.25000E-01 to  3.53553E-01
C                                        with weighted error   1.06E-32
C                                         log weighted error  31.98
C                               significant figures required  30.61
C                                    decimal places required  32.81
C
C
C Series for BIP2       on the interval  0.          to  1.25000E-01
C                                        with weighted error   4.04E-33
C                                         log weighted error  32.39
C                               significant figures required  31.15
C                                    decimal places required  33.37
C
C***REFERENCES  (NONE)
C***ROUTINES CALLED  D1MACH, D9AIMP, DCSEVL, INITDS
C***REVISION HISTORY  (YYMMDD)
C   770701  DATE WRITTEN
C   890531  Changed all specific intrinsics to generic.  (WRB)
C   890531  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C***END PROLOGUE  DBIE
C============
C idecl:  explicitize implicit INTEGER declarations:
      IMPLICIT NONE
      integer, parameter :: r8 = selected_real_kind(12,100)
      INTEGER nbif,nbig,nbif2,nbig2,nbip1,nbip2,initds
C============
C idecl:  explicitize implicit REAL declarations:
      REAL*8 eta
C============
      REAL*8 X, BIFCS(13), BIGCS(13), BIF2CS(15), BIG2CS(15),
     1  BIP1CS(47), BIP2CS(88), ATR, BTR, SQRTX, THETA, XBIG, XM, X3SML,
     2  X32SML, Z, D1MACH, DCSEVL
      LOGICAL FIRST
      SAVE BIFCS, BIGCS, BIF2CS, BIG2CS, BIP1CS, BIP2CS, ATR, BTR,
     1 NBIF, NBIG, NBIF2, NBIG2, NBIP1, NBIP2, X3SML, X32SML, XBIG,
     2 FIRST
      DATA BIFCS(  1) / -.16730216471986649483537423928176E-1_r8/
      DATA BIFCS(  2) / +.10252335834249445611426362777757E+0_r8/
      DATA BIFCS(  3) / +.17083092507381516539429650242013E-2_r8/
      DATA BIFCS(  4) / +.11862545467744681179216459210040E-4_r8/
      DATA BIFCS(  5) / +.44932907017792133694531887927242E-7_r8/
      DATA BIFCS(  6) / +.10698207143387889067567767663628E-9_r8/
      DATA BIFCS(  7) / +.17480643399771824706010517628573E-12_r8/
      DATA BIFCS(  8) / +.20810231071761711025881891834399E-15_r8/
      DATA BIFCS(  9) / +.18849814695665416509927971733333E-18_r8/
      DATA BIFCS( 10) / +.13425779173097804625882666666666E-21_r8/
      DATA BIFCS( 11) / +.77159593429658887893333333333333E-25_r8/
      DATA BIFCS( 12) / +.36533879617478566399999999999999E-28_r8/
      DATA BIFCS( 13) / +.14497565927953066666666666666666E-31_r8/
      DATA BIGCS(  1) / +.22466223248574522283468220139024E-1_r8/
      DATA BIGCS(  2) / +.37364775453019545441727561666752E-1_r8/
      DATA BIGCS(  3) / +.44476218957212285696215294326639E-3_r8/
      DATA BIGCS(  4) / +.24708075636329384245494591948882E-5_r8/
      DATA BIGCS(  5) / +.79191353395149635134862426285596E-8_r8/
      DATA BIGCS(  6) / +.16498079851827779880887872402706E-10_r8/
      DATA BIGCS(  7) / +.24119906664835455909247501122841E-13_r8/
      DATA BIGCS(  8) / +.26103736236091436985184781269333E-16_r8/
      DATA BIGCS(  9) / +.21753082977160323853123792000000E-19_r8/
      DATA BIGCS( 10) / +.14386946400390433219483733333333E-22_r8/
      DATA BIGCS( 11) / +.77349125612083468629333333333333E-26_r8/
      DATA BIGCS( 12) / +.34469292033849002666666666666666E-29_r8/
      DATA BIGCS( 13) / +.12938919273216000000000000000000E-32_r8/
      DATA BIF2CS(  1) / +.0998457269381604104468284257993E+0_r8/
      DATA BIF2CS(  2) / +.47862497786300553772211467318231E+0_r8/
      DATA BIF2CS(  3) / +.25155211960433011771324415436675E-1_r8/
      DATA BIF2CS(  4) / +.58206938852326456396515697872216E-3_r8/
      DATA BIF2CS(  5) / +.74997659644377865943861457378217E-5_r8/
      DATA BIF2CS(  6) / +.61346028703493836681403010356474E-7_r8/
      DATA BIF2CS(  7) / +.34627538851480632900434268733359E-9_r8/
      DATA BIF2CS(  8) / +.14288910080270254287770846748931E-11_r8/
      DATA BIF2CS(  9) / +.44962704298334641895056472179200E-14_r8/
      DATA BIF2CS( 10) / +.11142323065833011708428300106666E-16_r8/
      DATA BIF2CS( 11) / +.22304791066175002081517866666666E-19_r8/
      DATA BIF2CS( 12) / +.36815778736393142842922666666666E-22_r8/
      DATA BIF2CS( 13) / +.50960868449338261333333333333333E-25_r8/
      DATA BIF2CS( 14) / +.60003386926288554666666666666666E-28_r8/
      DATA BIF2CS( 15) / +.60827497446570666666666666666666E-31_r8/
      DATA BIG2CS(  1) / +.033305662145514340465176188111647E+0_r8/
      DATA BIG2CS(  2) / +.161309215123197067613287532084943E+0_r8/
      DATA BIG2CS(  3) / +.631900730961342869121615634921173E-2_r8/
      DATA BIG2CS(  4) / +.118790456816251736389780192304567E-3_r8/
      DATA BIG2CS(  5) / +.130453458862002656147116485012843E-5_r8/
      DATA BIG2CS(  6) / +.937412599553521729546809615508936E-8_r8/
      DATA BIG2CS(  7) / +.474580188674725153788510169834595E-10_r8/
      DATA BIG2CS(  8) / +.178310726509481399800065667560946E-12_r8/
      DATA BIG2CS(  9) / +.516759192784958180374276356640000E-15_r8/
      DATA BIG2CS( 10) / +.119004508386827125129496251733333E-17_r8/
      DATA BIG2CS( 11) / +.222982880666403517277063466666666E-20_r8/
      DATA BIG2CS( 12) / +.346551923027689419722666666666666E-23_r8/
      DATA BIG2CS( 13) / +.453926336320504514133333333333333E-26_r8/
      DATA BIG2CS( 14) / +.507884996513522346666666666666666E-29_r8/
      DATA BIG2CS( 15) / +.491020674696533333333333333333333E-32_r8/
      DATA BIP1CS(  1) / -.83220474779434474687471864707973E-1_r8/
      DATA BIP1CS(  2) / +.11461189273711742889920226128031E-1_r8/
      DATA BIP1CS(  3) / +.42896440718911509494134472566635E-3_r8/
      DATA BIP1CS(  4) / -.14906639379950514017847677732954E-3_r8/
      DATA BIP1CS(  5) / -.13076597267876290663136340998881E-4_r8/
      DATA BIP1CS(  6) / +.63275983961030344754535716032494E-5_r8/
      DATA BIP1CS(  7) / -.42226696982681924884778515889433E-6_r8/
      DATA BIP1CS(  8) / -.19147186298654689632835494181277E-6_r8/
      DATA BIP1CS(  9) / +.64531062845583173611038157880934E-7_r8/
      DATA BIP1CS( 10) / -.78448546771397719289748310448628E-8_r8/
      DATA BIP1CS( 11) / -.96077216623785085879198533565432E-9_r8/
      DATA BIP1CS( 12) / +.70004713316443966339006074402068E-9_r8/
      DATA BIP1CS( 13) / -.17731789132814932022083128056698E-9_r8/
      DATA BIP1CS( 14) / +.22720894783465236347282126389311E-10_r8/
      DATA BIP1CS( 15) / +.16540456313972049847032860681891E-11_r8/
      DATA BIP1CS( 16) / -.18517125559292316390755369896693E-11_r8/
      DATA BIP1CS( 17) / +.59576312477117290165680715534277E-12_r8/
      DATA BIP1CS( 18) / -.12194348147346564781055769498986E-12_r8/
      DATA BIP1CS( 19) / +.13347869253513048815386347813597E-13_r8/
      DATA BIP1CS( 20) / +.17278311524339746664384792889731E-14_r8/
      DATA BIP1CS( 21) / -.14590732013016720735268871713166E-14_r8/
      DATA BIP1CS( 22) / +.49010319927115819978994989520104E-15_r8/
      DATA BIP1CS( 23) / -.11556545519261548129262972762521E-15_r8/
      DATA BIP1CS( 24) / +.19098807367072411430671732441524E-16_r8/
      DATA BIP1CS( 25) / -.11768966854492179886913995957862E-17_r8/
      DATA BIP1CS( 26) / -.63271925149530064474537459677047E-18_r8/
      DATA BIP1CS( 27) / +.33861838880715361614130191322316E-18_r8/
      DATA BIP1CS( 28) / -.10725825321758625254992162219622E-18_r8/
      DATA BIP1CS( 29) / +.25995709605617169284786933115562E-19_r8/
      DATA BIP1CS( 30) / -.48477583571081193660962309494101E-20_r8/
      DATA BIP1CS( 31) / +.55298913982121625361505513198933E-21_r8/
      DATA BIP1CS( 32) / +.49421660826069471371748197444266E-22_r8/
      DATA BIP1CS( 33) / -.55162121924145707458069720814933E-22_r8/
      DATA BIP1CS( 34) / +.21437560417632550086631884499626E-22_r8/
      DATA BIP1CS( 35) / -.61910313387655605798785061137066E-23_r8/
      DATA BIP1CS( 36) / +.14629362707391245659830967336959E-23_r8/
      DATA BIP1CS( 37) / -.27918484471059005576177866069333E-24_r8/
      DATA BIP1CS( 38) / +.36455703168570246150906795349333E-25_r8/
      DATA BIP1CS( 39) / +.58511821906188711839382459733333E-27_r8/
      DATA BIP1CS( 40) / -.24946950487566510969745047551999E-26_r8/
      DATA BIP1CS( 41) / +.10979323980338380977919579477333E-26_r8/
      DATA BIP1CS( 42) / -.34743388345961115015034088106666E-27_r8/
      DATA BIP1CS( 43) / +.91373402635349697363171082240000E-28_r8/
      DATA BIP1CS( 44) / -.20510352728210629186247720959999E-28_r8/
      DATA BIP1CS( 45) / +.37976985698546461748651622399999E-29_r8/
      DATA BIP1CS( 46) / -.48479458497755565887848448000000E-30_r8/
      DATA BIP1CS( 47) / -.10558306941230714314205866666666E-31_r8/
      DATA BIP2CS(  1) / -.11359673758598867913797310895527E+0_r8/
      DATA BIP2CS(  2) / +.41381473947881595760052081171444E-2_r8/
      DATA BIP2CS(  3) / +.13534706221193329857696921727508E-3_r8/
      DATA BIP2CS(  4) / +.10427316653015353405887183456780E-4_r8/
      DATA BIP2CS(  5) / +.13474954767849907889589911958925E-5_r8/
      DATA BIP2CS(  6) / +.16965374054383983356062511163756E-6_r8/
      DATA BIP2CS(  7) / -.10096500865641624301366228396373E-7_r8/
      DATA BIP2CS(  8) / -.16729119493778475127836973095943E-7_r8/
      DATA BIP2CS(  9) / -.45815364485068383217152795613391E-8_r8/
      DATA BIP2CS( 10) / +.37366813665655477274064749384284E-9_r8/
      DATA BIP2CS( 11) / +.57669303201452448119584643502111E-9_r8/
      DATA BIP2CS( 12) / +.62181265087850324095393408792371E-10_r8/
      DATA BIP2CS( 13) / -.63294120282743068241589177281354E-10_r8/
      DATA BIP2CS( 14) / -.14915047908598767633999091989487E-10_r8/
      DATA BIP2CS( 15) / +.78896213942486771938172394294891E-11_r8/
      DATA BIP2CS( 16) / +.24960513721857797984888064000127E-11_r8/
      DATA BIP2CS( 17) / -.12130075287291659477746664734814E-11_r8/
      DATA BIP2CS( 18) / -.37404939108727277887343460402716E-12_r8/
      DATA BIP2CS( 19) / +.22377278140321476798783446931091E-12_r8/
      DATA BIP2CS( 20) / +.47490296312192466341986077472514E-13_r8/
      DATA BIP2CS( 21) / -.45261607991821224810605655831294E-13_r8/
      DATA BIP2CS( 22) / -.30172271841986072645112245876020E-14_r8/
      DATA BIP2CS( 23) / +.91058603558754058327592683478908E-14_r8/
      DATA BIP2CS( 24) / -.98149238033807062926643864207709E-15_r8/
      DATA BIP2CS( 25) / -.16429400647889465253601245251589E-14_r8/
      DATA BIP2CS( 26) / +.55334834214274215451182114635164E-15_r8/
      DATA BIP2CS( 27) / +.21750479864482655984374381998156E-15_r8/
      DATA BIP2CS( 28) / -.17379236200220656971287029558087E-15_r8/
      DATA BIP2CS( 29) / -.10470023471443714959283909313604E-17_r8/
      DATA BIP2CS( 30) / +.39219145986056386925441403311462E-16_r8/
      DATA BIP2CS( 31) / -.11621293686345196925824005665910E-16_r8/
      DATA BIP2CS( 32) / -.54027474491754245533735411307773E-17_r8/
      DATA BIP2CS( 33) / +.45441582123884610882675428553304E-17_r8/
      DATA BIP2CS( 34) / -.28775599625221075729427585480086E-18_r8/
      DATA BIP2CS( 35) / -.10017340927225341243596162960440E-17_r8/
      DATA BIP2CS( 36) / +.44823931215068369856332561906313E-18_r8/
      DATA BIP2CS( 37) / +.76135968654908942328948982366775E-19_r8/
      DATA BIP2CS( 38) / -.14448324094881347238956060145422E-18_r8/
      DATA BIP2CS( 39) / +.40460859449205362251624847392112E-19_r8/
      DATA BIP2CS( 40) / +.20321085700338446891325190707277E-19_r8/
      DATA BIP2CS( 41) / -.19602795471446798718272758041962E-19_r8/
      DATA BIP2CS( 42) / +.34273038443944824263518958211738E-20_r8/
      DATA BIP2CS( 43) / +.37023705853905135480024651593154E-20_r8/
      DATA BIP2CS( 44) / -.26879595172041591131400332966712E-20_r8/
      DATA BIP2CS( 45) / +.28121678463531712209714454683364E-21_r8/
      DATA BIP2CS( 46) / +.60933963636177797173271119680329E-21_r8/
      DATA BIP2CS( 47) / -.38666621897150844994172977893413E-21_r8/
      DATA BIP2CS( 48) / +.25989331253566943450895651927228E-22_r8/
      DATA BIP2CS( 49) / +.97194393622938503767281175216084E-22_r8/
      DATA BIP2CS( 50) / -.59392817834375098415630478204591E-22_r8/
      DATA BIP2CS( 51) / +.38864949977113015409591960439444E-23_r8/
      DATA BIP2CS( 52) / +.15334307393617272869721512868769E-22_r8/
      DATA BIP2CS( 53) / -.97513555209762624036336521409724E-23_r8/
      DATA BIP2CS( 54) / +.96340644440489471424741339383726E-24_r8/
      DATA BIP2CS( 55) / +.23841999400208880109946748792454E-23_r8/
      DATA BIP2CS( 56) / -.16896986315019706184848044205207E-23_r8/
      DATA BIP2CS( 57) / +.27352715888928361222578444801478E-24_r8/
      DATA BIP2CS( 58) / +.35660016185409578960111685025730E-24_r8/
      DATA BIP2CS( 59) / -.30234026608258827249534280666954E-24_r8/
      DATA BIP2CS( 60) / +.75002041605973930653144204823232E-25_r8/
      DATA BIP2CS( 61) / +.48403287575851388827455319838748E-25_r8/
      DATA BIP2CS( 62) / -.54364137654447888432698010297766E-25_r8/
      DATA BIP2CS( 63) / +.19281214470820962653345978809756E-25_r8/
      DATA BIP2CS( 64) / +.50116355020532656659611814172172E-26_r8/
      DATA BIP2CS( 65) / -.95040744582693253786034620869972E-26_r8/
      DATA BIP2CS( 66) / +.46372646157101975948696332245611E-26_r8/
      DATA BIP2CS( 67) / +.21177170704466954163768170577046E-28_r8/
      DATA BIP2CS( 68) / -.15404850268168594303692204548726E-26_r8/
      DATA BIP2CS( 69) / +.10387944293201213662047889194441E-26_r8/
      DATA BIP2CS( 70) / -.19890078156915416751316728235153E-27_r8/
      DATA BIP2CS( 71) / -.21022173878658495471177044522532E-27_r8/
      DATA BIP2CS( 72) / +.21353099724525793150633356670491E-27_r8/
      DATA BIP2CS( 73) / -.79040810747961342319023537632627E-28_r8/
      DATA BIP2CS( 74) / -.16575359960435585049973741763592E-28_r8/
      DATA BIP2CS( 75) / +.38868342850124112587625586496537E-28_r8/
      DATA BIP2CS( 76) / -.22309237330896866182621562424717E-28_r8/
      DATA BIP2CS( 77) / +.27777244420176260265625977404382E-29_r8/
      DATA BIP2CS( 78) / +.57078543472657725368712433782772E-29_r8/
      DATA BIP2CS( 79) / -.51743084445303852800173371555280E-29_r8/
      DATA BIP2CS( 80) / +.18413280751095837198450927071569E-29_r8/
      DATA BIP2CS( 81) / +.44422562390957094598544071068647E-30_r8/
      DATA BIP2CS( 82) / -.98504142639629801547464958226943E-30_r8/
      DATA BIP2CS( 83) / +.58857201353585104884754198881995E-30_r8/
      DATA BIP2CS( 84) / -.97636075440429787961402312628595E-31_r8/
      DATA BIP2CS( 85) / -.13581011996074695047063597884122E-30_r8/
      DATA BIP2CS( 86) / +.13999743518492413270568048380345E-30_r8/
      DATA BIP2CS( 87) / -.59754904545248477620884562981118E-31_r8/
      DATA BIP2CS( 88) / -.40391653875428313641045327529856E-32_r8/
      DATA ATR / 8.75069057084843450880771988210148_r8/
      DATA BTR / -2.09383632135605431360096498526268_r8/
      DATA FIRST /.TRUE./
C***FIRST EXECUTABLE STATEMENT  DBIE
      IF (FIRST) THEN
         ETA = 0.1_r8*real(D1MACH(3),r8)
         NBIF = INITDS (BIFCS, 13, ETA)
         NBIG = INITDS (BIGCS, 13, ETA)
         NBIF2 = INITDS (BIF2CS, 15, ETA)
         NBIG2 = INITDS (BIG2CS, 15, ETA)
         NBIP1 = INITDS (BIP1CS, 47, ETA)
         NBIP2 = INITDS (BIP2CS, 88, ETA)
C
         X3SML = ETA**0.3333_r8
         X32SML = 1.3104_r8*X3SML**2
         XBIG = D1MACH(2)**0.6666_r8
      ENDIF
      FIRST = .FALSE.
C
      IF (X.GE.(-1.0_r8)) GO TO 20
      CALL D9AIMP (X, XM, THETA)
      DBIE = XM * SIN(THETA)
      RETURN
C
 20   IF (X.GT.1.0_r8) GO TO 30
      Z = 0._r8
      IF (ABS(X).GT.X3SML) Z = X**3
      DBIE = 0.625_r8+ DCSEVL (Z, BIFCS, NBIF) +
     1   X*(0.4375_r8+
     1   DCSEVL (Z, BIGCS, NBIG) )
      IF (X.GT.X32SML) DBIE = DBIE *
     1   EXP(-2.0_r8*X*SQRT(X)/3.0_r8)
      RETURN
C
 30   IF (X.GT.2.0_r8) GO TO 40
      Z = (2.0_r8*X**3 - 9.0_r8)/7.0_r8
      DBIE = EXP(-2.0_r8*X*SQRT(X)/3.0_r8) *
     1   (1.125_r8+ DCSEVL (Z, BIF2CS,
     2   NBIF2) + X*(0.625_r8+ DCSEVL (Z, BIG2CS, NBIG2)) )
      RETURN
C
 40   IF (X.GT.4.0_r8) GO TO 50
      SQRTX = SQRT(X)
      Z = ATR/(X*SQRTX) + BTR
      DBIE = (0.625_r8+ DCSEVL (Z, BIP1CS, NBIP1))/SQRT(SQRTX)
      RETURN
C
 50   SQRTX = SQRT(X)
      Z = -1.0_r8
      IF (X.LT.XBIG) Z = 16._r8/(X*SQRTX) - 1.0_r8
      DBIE = (0.625_r8+ DCSEVL (Z, BIP2CS, NBIP2))/SQRT(SQRTX)
      RETURN
C
      END
! 22Jun2000 fgtok -s r8_precision.sub "r8con.csh conversion"
! 22Jun2000 fgtok
! 22Jun2000 fgtok
! 22Jun2000 fgtok
