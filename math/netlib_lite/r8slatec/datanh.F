*DECK DATANH
      REAL*8 FUNCTION DATANH (X)
C***BEGIN PROLOGUE  DATANH
C***PURPOSE  Compute the arc hyperbolic tangent.
C***LIBRARY   SLATEC (FNLIB)
C***CATEGORY  C4C
C***TYPE      REAL*8 (ATANH-S, DATANH-D, CATANH-C)
C***KEYWORDS  ARC HYPERBOLIC TANGENT, ATANH, ELEMENTARY FUNCTIONS,
C             FNLIB, INVERSE HYPERBOLIC TANGENT
C***AUTHOR  Fullerton, W., (LANL)
C***DESCRIPTION
C
C DATANH(X) calculates the double precision arc hyperbolic
C tangent for double precision argument X.
C
C Series for ATNH       on the interval  0.          to  2.50000E-01
C                                        with weighted error   6.86E-32
C                                         log weighted error  31.16
C                               significant figures required  30.00
C                                    decimal places required  31.88
C
C***REFERENCES  (NONE)
C***ROUTINES CALLED  D1MACH, DCSEVL, INITDS, XERMSG
C***REVISION HISTORY  (YYMMDD)
C   770601  DATE WRITTEN
C   890531  Changed all specific intrinsics to generic.  (WRB)
C   890531  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
C***END PROLOGUE  DATANH
C============
C idecl:  explicitize implicit INTEGER declarations:
      IMPLICIT NONE
      integer, parameter :: r8 = selected_real_kind(12,100)
      INTEGER nterms,initds
C============
      REAL*8 X, ATNHCS(27), DXREL, SQEPS, Y, DCSEVL, D1MACH
      LOGICAL FIRST
      SAVE ATNHCS, NTERMS, DXREL, SQEPS, FIRST
      DATA ATNHCS(  1) / +.9439510239319549230842892218633E-1_r8/
      DATA ATNHCS(  2) / +.4919843705578615947200034576668E-1_r8/
      DATA ATNHCS(  3) / +.2102593522455432763479327331752E-2_r8/
      DATA ATNHCS(  4) / +.1073554449776116584640731045276E-3_r8/
      DATA ATNHCS(  5) / +.5978267249293031478642787517872E-5_r8/
      DATA ATNHCS(  6) / +.3505062030889134845966834886200E-6_r8/
      DATA ATNHCS(  7) / +.2126374343765340350896219314431E-7_r8/
      DATA ATNHCS(  8) / +.1321694535715527192129801723055E-8_r8/
      DATA ATNHCS(  9) / +.8365875501178070364623604052959E-10_r8/
      DATA ATNHCS( 10) / +.5370503749311002163881434587772E-11_r8/
      DATA ATNHCS( 11) / +.3486659470157107922971245784290E-12_r8/
      DATA ATNHCS( 12) / +.2284549509603433015524024119722E-13_r8/
      DATA ATNHCS( 13) / +.1508407105944793044874229067558E-14_r8/
      DATA ATNHCS( 14) / +.1002418816804109126136995722837E-15_r8/
      DATA ATNHCS( 15) / +.6698674738165069539715526882986E-17_r8/
      DATA ATNHCS( 16) / +.4497954546494931083083327624533E-18_r8/
      DATA ATNHCS( 17) / +.3032954474279453541682367146666E-19_r8/
      DATA ATNHCS( 18) / +.2052702064190936826463861418666E-20_r8/
      DATA ATNHCS( 19) / +.1393848977053837713193014613333E-21_r8/
      DATA ATNHCS( 20) / +.9492580637224576971958954666666E-23_r8/
      DATA ATNHCS( 21) / +.6481915448242307604982442666666E-24_r8/
      DATA ATNHCS( 22) / +.4436730205723615272632320000000E-25_r8/
      DATA ATNHCS( 23) / +.3043465618543161638912000000000E-26_r8/
      DATA ATNHCS( 24) / +.2091881298792393474047999999999E-27_r8/
      DATA ATNHCS( 25) / +.1440445411234050561365333333333E-28_r8/
      DATA ATNHCS( 26) / +.9935374683141640465066666666666E-30_r8/
      DATA ATNHCS( 27) / +.6863462444358260053333333333333E-31_r8/
      DATA FIRST /.TRUE./
C***FIRST EXECUTABLE STATEMENT  DATANH
      IF (FIRST) THEN
         NTERMS = INITDS (ATNHCS, 27, 0.1_r8*real(D1MACH(3),r8) )
         DXREL = SQRT(D1MACH(4))
         SQEPS = SQRT(3.0_r8*D1MACH(3))
      ENDIF
      FIRST = .FALSE.
C
      Y = ABS(X)
      IF (Y .GE. 1._r8) CALL XERMSG
     +   ('SLATEC', 'DATANH', 'ABS(X) GE 1', 2, 2)
C
      IF (1._r8-Y .LT. DXREL) CALL XERMSG ('SLATEC', 'DATANH',
     +   'ANSWER LT HALF PRECISION BECAUSE ABS(X) TOO NEAR 1', 1, 1)
C
      DATANH = X
      IF (Y.GT.SQEPS .AND. Y.LE.0.5_r8) DATANH = X*(1.0_r8+
     1  DCSEVL (8._r8*X*X-1._r8, ATNHCS, NTERMS) )
      IF (Y.GT.0.5_r8) DATANH =
     1   0.5_r8*LOG ((1.0_r8+X)/(1.0_r8-X))
C
      RETURN
      END
! 22Jun2000 fgtok -s r8_precision.sub "r8con.csh conversion"
! 22Jun2000 fgtok
! 22Jun2000 fgtok
! 22Jun2000 fgtok
