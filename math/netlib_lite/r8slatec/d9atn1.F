*DECK D9ATN1
      REAL*8 FUNCTION D9ATN1 (X)
C***BEGIN PROLOGUE  D9ATN1
C***SUBSIDIARY
C***PURPOSE  Evaluate DATAN(X) from first order relative accuracy so
C            that DATAN(X) = X + X**3*D9ATN1(X).
C***LIBRARY   SLATEC (FNLIB)
C***CATEGORY  C4A
C***TYPE      REAL*8 (R9ATN1-S, D9ATN1-D)
C***KEYWORDS  ARC TANGENT, ELEMENTARY FUNCTIONS, FIRST ORDER, FNLIB,
C             TRIGONOMETRIC
C***AUTHOR  Fullerton, W., (LANL)
C***DESCRIPTION
C
C Evaluate  DATAN(X)  from first order, that is, evaluate
C (DATAN(X)-X)/X**3  with relative error accuracy so that
C        DATAN(X) = X + X**3*D9ATN1(X).
C
C Series for ATN1       on the interval  0.          to  1.00000E+00
C                                        with weighted error   3.39E-32
C                                         log weighted error  31.47
C                               significant figures required  30.26
C                                    decimal places required  32.27
C
C***REFERENCES  (NONE)
C***ROUTINES CALLED  D1MACH, DCSEVL, INITDS, XERMSG
C***REVISION HISTORY  (YYMMDD)
C   780401  DATE WRITTEN
C   890531  Changed all specific intrinsics to generic.  (WRB)
C   891115  Corrected third argument in reference to INITDS.  (WRB)
C   891115  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
C   900720  Routine changed from user-callable to subsidiary.  (WRB)
C***END PROLOGUE  D9ATN1
C============
C idecl:  explicitize implicit INTEGER declarations:
      IMPLICIT NONE
      integer, parameter :: r8 = selected_real_kind(12,100)
      INTEGER ntatn1,initds
C============
      REAL*8 X, XBIG, XMAX, XSML, Y, ATN1CS(40), EPS,
     1  DCSEVL, D1MACH
      LOGICAL FIRST
      SAVE ATN1CS, NTATN1, XSML, XBIG, XMAX, FIRST
      DATA ATN1CS(  1) / -.3283997535355202356907939922990E-1_r8/
      DATA ATN1CS(  2) / +.5833432343172412449951669914907E-1_r8/
      DATA ATN1CS(  3) / -.7400369696719646463809011551413E-2_r8/
      DATA ATN1CS(  4) / +.1009784199337288083590357511639E-2_r8/
      DATA ATN1CS(  5) / -.1439787163565205621471303697700E-3_r8/
      DATA ATN1CS(  6) / +.2114512648992107572072112243439E-4_r8/
      DATA ATN1CS(  7) / -.3172321074254667167402564996757E-5_r8/
      DATA ATN1CS(  8) / +.4836620365460710825377859384800E-6_r8/
      DATA ATN1CS(  9) / -.7467746546814112670437614322776E-7_r8/
      DATA ATN1CS( 10) / +.1164800896824429830620998641342E-7_r8/
      DATA ATN1CS( 11) / -.1832088370847201392699956242452E-8_r8/
      DATA ATN1CS( 12) / +.2901908277966063313175351230455E-9_r8/
      DATA ATN1CS( 13) / -.4623885312106326738351805721512E-10_r8/
      DATA ATN1CS( 14) / +.7405528668775736917992197048286E-11_r8/
      DATA ATN1CS( 15) / -.1191354457845136682370820373417E-11_r8/
      DATA ATN1CS( 16) / +.1924090144391772599867855692518E-12_r8/
      DATA ATN1CS( 17) / -.3118271051076194272254476155327E-13_r8/
      DATA ATN1CS( 18) / +.5069240036567731789694520593032E-14_r8/
      DATA ATN1CS( 19) / -.8263694719802866053818284405964E-15_r8/
      DATA ATN1CS( 20) / +.1350486709817079420526506123029E-15_r8/
      DATA ATN1CS( 21) / -.2212023650481746045840137823191E-16_r8/
      DATA ATN1CS( 22) / +.3630654747381356783829047647709E-17_r8/
      DATA ATN1CS( 23) / -.5970345328847154052451215859165E-18_r8/
      DATA ATN1CS( 24) / +.9834816050077133119448329005738E-19_r8/
      DATA ATN1CS( 25) / -.1622655075855062336144387604480E-19_r8/
      DATA ATN1CS( 26) / +.2681186176945436796301320301226E-20_r8/
      DATA ATN1CS( 27) / -.4436309706785255479636243688106E-21_r8/
      DATA ATN1CS( 28) / +.7349691897652496945072465510400E-22_r8/
      DATA ATN1CS( 29) / -.1219077508350052588289401378133E-22_r8/
      DATA ATN1CS( 30) / +.2024298836805215403184540876799E-23_r8/
      DATA ATN1CS( 31) / -.3364871555797354579925576362666E-24_r8/
      DATA ATN1CS( 32) / +.5598673968346988749492933973333E-25_r8/
      DATA ATN1CS( 33) / -.9323939267272320229628532053333E-26_r8/
      DATA ATN1CS( 34) / +.1554133116995970222934807893333E-26_r8/
      DATA ATN1CS( 35) / -.2592569534179745922757427199999E-27_r8/
      DATA ATN1CS( 36) / +.4328193466245734685037909333333E-28_r8/
      DATA ATN1CS( 37) / -.7231013125595437471192405333333E-29_r8/
      DATA ATN1CS( 38) / +.1208902859830494772942165333333E-29_r8/
      DATA ATN1CS( 39) / -.2022404543449897579315199999999E-30_r8/
      DATA ATN1CS( 40) / +.3385428713046493843073706666666E-31_r8/
      DATA FIRST /.TRUE./
C***FIRST EXECUTABLE STATEMENT  D9ATN1
      IF (FIRST) THEN
         EPS = D1MACH(3)
         NTATN1 = INITDS (ATN1CS, 40, 0.1_r8*real(EPS,r8))
C
         XSML = SQRT (0.1_r8*EPS)
         XBIG = 1.571_r8/SQRT(EPS)
         XMAX = 1.571_r8/EPS
      ENDIF
      FIRST = .FALSE.
C
      Y = ABS(X)
      IF (Y.GT.1.0_r8) GO TO 20
C
      IF (Y.LE.XSML) D9ATN1 = -1.0_r8/3.0_r8
      IF (Y.LE.XSML) RETURN
C
      D9ATN1 = -0.25_r8+
     >   DCSEVL (2._r8*Y*Y-1._r8, ATN1CS, NTATN1)
      RETURN
C
 20   IF (Y .GT. XMAX) CALL XERMSG ('SLATEC', 'D9ATN1',
     +   'NO PRECISION IN ANSWER BECAUSE X IS TOO BIG', 2, 2)
      IF (Y .GT. XBIG) CALL XERMSG ('SLATEC', 'D9ATN1',
     +   'ANSWER LT HALF PRECISION BECAUSE X IS TOO BIG', 1, 1)
C
      D9ATN1 = (ATAN(X) - X) / X**3
      RETURN
C
      END
! 22Jun2000 fgtok -s r8_precision.sub "r8con.csh conversion"
! 22Jun2000 fgtok
! 22Jun2000 fgtok
! 22Jun2000 fgtok
